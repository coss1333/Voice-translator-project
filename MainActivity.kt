/* Kotlin code omitted for brevity; identical to one in chat */